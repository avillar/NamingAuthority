
 

Open Geospatial Consortium 

Date: 2012-03-17 

Publication Date: 2012-08-27 

External identifier of this OGC
®

 docu ment:  http://www.opengis.net/doc/ie/swie 

Reference number of this document: OGC 12-018r2 

Category: OGC® Int eroperability Experiment R eport  

Editors : Peter Fitch  

OGC
®
 Surface Water Interoperability Experiment 

FINAL REPORT 

 

Copyright © 2012 Open Geospatial Consortium 
To obtain additional rights of use, visit http://www.opengeospatial.org/legal/. 

Warning 

This document is not an OGC Standard. This document is an OGC Public 

Engineering Report created as a deliverable in an OGC Interoperability 
Initiative and is not an official position of the OGC membership. It is distributed 
for review and comment. It is subject to change without notice and may not be 

referred to as an OGC Standard. Further, any OGC Engineering Report should 
not be referenced as required or mandatory technology in procurements. 

 

 

  

Document type:  OGC
® 

Engineering Report 

Document subtype:  NA 
Document st age:  Approved for public release 
Document language:  English 

http://www.opengeospatial.org/legal/


OGC 12-018r2 

ii Copyright © 2012 Open Geospati al Consortium  
 

License Agreement 

Permission is hereby  granted by  the Open Geospatial Consort ium, Inc. ("Licensor"), free of charge and subject to the terms se t forth 
below, to any  person obtain ing a copy  of this Intel lectual Property  and any  associated documentation, to deal in the Intel lectual 

Property  without restriction (except as set forth below), includ ing w ithou t limitat ion the rights to implement, use, copy , modify , 
merge, publish, dis tribute, and /or sub license copies of the Intel lectual Property , and to permit persons to whom the Intel lectual 

Property  is furnished to do so, provided that all copy right no tices on the intel lectual property  are retained intact and that  each 
person to whom the Intel lectual Property  is furnished agrees to the terms of this A greement. 

If you modify  the Intellectual Property , all copies of the modified Intellectual Property  must include, in addition to the above 
copy right notice, a notice that the Intellectual Property  includes modifications  that have no t been approved or adopted by  

LICENSO R.  

THIS LICEN SE IS A COPYRIGHT LI CENSE  ONLY, AND DOE S NOT CONVEY ANY RIGHT S UNDE R ANY PATENT S 
THAT MAY BE  IN FO RCE ANYWHE RE IN THE WO RLD.  

THE INTELLECTUAL P ROPERTY IS P ROVIDED "A S IS", WITHOUT WARRANTY O F ANY KIND, EXPRE SS O R 

IMPLIED, INCLUDING BUT NOT LIMITED  TO THE WARRANTIE S OF MERCHANTA BILITY, FITNE SS FO R A 

PARTICULAR PU RPOSE, AND NONIN FRINGE MENT OF THIRD PARTY RIGHT S. THE COPYRIGHT HOLDER OR 
HOLDERS IN CLUDED IN THI S NOTICE DO NOT  WARRANT THAT THE FUNCTIONS CONTAINED IN THE 

INTELLECTUAL PROPE RTY WILL MEET YOU R REQUIRE MENTS O R THAT TH E OPERATION O F THE 
INTELLECTUAL PROPE RTY WILL BE UNINTE RRUPTED O R E RRO R FREE. ANY  USE O F THE INTELL ECTUAL 

PROPERTY SHALL  BE MADE ENTIRELY AT THE U SER’S OWN RI SK. IN NO EVENT SHALL THE  COPYRIGHT 

HOLDER OR ANY CONT RIBUTO R O F INTELLECTUAL PROPERTY RIGHTS TO THE INTELLE CTUAL PROPE RTY BE 
LIABLE FO R ANY CLAIM, O R ANY DIRE CT, SPECIAL, INDIRE CT O R CON SEQUENTIAL DA MAGES, O R ANY 

DAMAGES WHAT SOEVE R RE SULTING FRO M ANY ALLEGED IN FRINGE MENT OR ANY LOSS O F USE, DATA O R 
PROFITS, WHE THER IN AN A CTION OF CONT RACT,  NEGLIGENCE O R UNDE R ANY OTHE R LEGAL THEO RY, 

ARISING OUT O F OR IN CONNE CTION WITH THE IMPLEMENTATION, U SE, COMMERCIALIZATION OR 
PERFORMANCE OF THI S INTELLE CTUAL PROPERTY.  

This l icense is effective until terminated. You may  terminate it at any  time by  destroy ing the Intellectual Property  together  with all 
copies in any  form. The license will also terminate if you fail to comply  with any  term or condition of this Agreement. Except as 

provided in the follow ing sentence, no such termination of this l icense shall require the termination  of any  third party  end -user 
sublicense to the Intellectual Property  which is in  force as of the date of notice of such termination. In add ition, should the 

Intellectual Property , or the operation of the Intellectual Property , infringe, or in LICEN SO R’s sole opinion be like ly  to in fringe, 
any  patent, copy right, trademark or other right  of a third party , you agree that LICENSOR, in i ts so le discretion , may  terminate this 

license withou t any  compensation or liabil ity  to you, your licensees or any  other party . You agree upon termination of any  kind to 

destroy  or cause to be destroyed the Intellectual Property  together with all copies in any  form, whether held by  you or by  any  third 
party . 

Except as contained in this notice, the name of LICENSO R or of any  other holder of a copy right in all  or part of the Intellec tual 

Property  shall not be used in advertising or o therwise to promote the sale, use or other dealings in this In tellectual Property  without 
prior written author izat ion of LICEN SO R or such copy right ho lder. LICEN SOR is and shall at all times be the sole ent ity  that may  

authorize you or any  third party  to use certification marks, tradem arks or other special designations  to indicate compliance with any  

LICENSO R standards or specifications.  

This Agreement is governed by  the laws of the Commonwealth of Massachusetts.  The application to this A greement of the United 
Nations Convention on Con tracts for the International Sale of Goods is hereby  expressly  excluded. In the event any  provision of 

this Agreement shall be deemed unenforceable, void or invalid, such provision shall be modified so as to ma ke it val id and 
enforceable, and as so modified the entire Agreement shall remain in full force and effect. No decision, action or inaction by  

LICENSO R shall be construed to  be a waiver of any  rights or remedies available to it.  

None of the Intellectual Property  or underly ing information or technology  may  be downloaded or otherwise exported or reexported 
in vio lation of U.S. export  laws and regulations. In add ition , you are responsible for comply ing with any  local laws in your 

jurisdiction wh ich may  impact your right to import, export or use the Intellectual Property , and you represent that you have 
complied with any  regulations or regis tration procedures required by  applicable law to make this license enforceable. 

 

 

 

 



OGC 12-018r2 

Copyright © 2012 Open Geospati al Consortium  iii 
 

Preface 

This report describes the methods, results, issues and recommendations generated by 

the Surface Water Interoperability Experiment (SW IE), carried out as an activity of the 
OGC Hydrology Domain Working Group (HDWG). The SW IE is designed to test 
WaterML2.0, and OGC services with surface water hydrology uses cases. 

Suggested additions, changes, and comments on this draft report are welcome and 

encouraged. Such suggestions may be submitted by email message or by making 
suggested changes in an edited copy of this document. 

The changes made in this document version, relative to the previous version, are 
tracked by Microsoft Word, and can be viewed if desired. If you choose to submit 

suggested changes by editing this document, please first accept all the current changes, 
and then make your suggested changes with change tracking on. 

 



OGC 12-018r2 

iv Copyright © 2012 Open Geospati al Consortium  
 

Contents Page 

1 Introduction.........................................................................................................................1 
1.1 Document contributor contact points..........................................................................1 
1.2 Revision history............................................................................................................2 
1.3 Future work...................................................................................................................2 

2 References ...........................................................................................................................2 

3 Terms and definitions.........................................................................................................3 

4 Conventions ........................................................................................................................3 
4.1 Abbreviated terms ........................................................................................................3 
4.2 UML notation ...............................................................................................................4 

5 SWIE Overview..................................................................................................................5 
5.1 Background...................................................................................................................5 
5.2 Motivation and Goals...................................................................................................5 
5.3 Structure of Report.......................................................................................................6 

6 Use Case 1 – Cross Border Data Exchange ......................................................................7 
6.1 Contributors ..................................................................................................................7 
6.2 Introduction ..................................................................................................................7 
6.3 Motivation and Goals...................................................................................................7 
6.4 Design and Implementation.........................................................................................8 
6.5 Results - outstanding issues .........................................................................................8 
6.6 Recommendations: .......................................................................................................9 

7 Use Case 2 - Forecasting..................................................................................................10 
7.1 Contributors ................................................................................................................10 
7.2 Introduction ................................................................................................................10 
7.3 Motivation and Goals.................................................................................................10 
7.4 Design and Implementation.......................................................................................10 
7.5 Results – outstanding issues ......................................................................................11 
7.6 Recommendations ......................................................................................................12 

8 Use Case 3 – Global Runoff ............................................................................................13 
8.1 Contributors ................................................................................................................13 
8.2 Introduction ................................................................................................................13 
8.3 Motivation and Goals.................................................................................................13 
8.4 Design and Implementation.......................................................................................13 
8.5 USGS SOS Services...................................................................................................14 
8.6 USGS SOS Service Results .......................................................................................14 

9 Results and  outstanding issues........................................................................................16 
9.1 SOS Version ...............................................................................................................16 
9.2 SOS Usage ..................................................................................................................16 
9.3 SWIE SOS Hydrology Profile...................................................................................17 

10 SW IE Client Implementation .......................................................................................22 
10.1 DelftFEWS SOS Client – Deltares .........................................................................22 

11 Acknowledgements ........................................................................................................26 



OGC 12-018r2 

Copyright © 2012 Open Geospati al Consortium  v 
 

Appendix 1 ............................................................................................................................. 27 

Appendix 2 - Activity plan Use Cases .................................................................................. 28 
 



OGC 12-018r2 

vi Copyright © 2012 Open Geospati al Consortium  
 

Figures Page 

Figure 1: schematic overview of technology and data sources ............................................. 8 

Figure 2: Architecture of the system for use case 3 .............................................................14 

  

 



O GC
®
 Surfacewater Interoperability Experiment Final Report O GC 12-018r2 

 

Copyright © 2012 Open Geospati al Consortium  1 
 

 

1 INTRODUCTION 

This report describes the methods, results, issues and recommendations generated by 

the Surface Water Interoperability Experiment (SW IE), carried out as an activity of the 
OGC Hydrology Domain Working Group (HDWG). The SW IE was designed to 
advance the development of WaterML 2.0 and test its use with various OGC service 

standards (SOS, WFS, WMS and CSW). A secondary aim was to contribute to the 
development of a hydrology domain feature model and vocabularies, which are 
essential for interoperability in the hydrology domain, although these are not the main 
focus for the IE.  

The use of O&M compliant WaterML 2.0 and OGC web services for data exchange 
will allow for easier access to and consistent interpretation of water data. The ultimate 
use of this data will depend on the context of participating organizations and their 

driving requirements.  

Surface water datasets typically contain a large number of observations at a small 
number of locations, which has tested WaterML 2.0 in new ways. This contrasts and 
complements the first HSWG Groundwater IE, in which for groundwater observations, 

there are typically small in number, taken at many locations. 

Attention is drawn to the possibility that some of the elements of this document may be 

the subject of patent rights. The Open Geospatial Consortium Inc. shall not be held 
responsible for identifying any or all such patent rights. 

Recipients of this document are requested to submit, with their comments, notification 
of any relevant patent claims or other intellectual property rights of which they may be 

aware that might be infringed by any implementation of the standard set forth in this 
document, and to provide supporting documentation. 

1.1 Document contributor contact points 

All questions regarding this document should be directed to the editors or contributors: 

Name Organization  

Peter Fitch  CSIRO 

Michael Utech KISTERS 

Stefan Fuest  KISTERS 

Michael Natschke KISTERS 

Carst en Heidmann  disy Informationssyst eme GmbH 

Jon Halquist NOAA/NWS  

Peter Gijsbers  Delt ares USA 

Laura De Cicco  USGS  

Sylvain Grellet  Offi ce International de l’Eau (OlEau) - 

Sandre 

 



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

2 Copyright © 2012 Open Geospati al Consortium  
 

 

1.2 Revision history 

Date Release Editor Primary clauses 
modified 

Descrip tion 

12/12/2011 1.0 Peter 

Fitch 

original document   

17/3/2012 1.1 Peter 

Fitch 

Various editorial 

changes  

 

20/7/2012 1.2 Peter 

Fitch 

Additional content 

from IOW Sandre 

Additional content from Sylvain Grell et, IOW 

and final edits.  

 

 

1.3 Future work 

Future improvements to this document are desirable to clarify technical details arising 
from subsequent implementation of OGC standards and related technologies . In 

particular the finalization of SOS2.0 has occurred during the writing of this report and 
needs to be more fully tested with WaterML 2.0 as only some aspects were tested 
during this IE. 

Aspects of the SW IE will continue informally amongst participants interested in 

maintaining and expanding surfacewater data sharing.  

 

2 REFERENCES 

The following documents are referenced in this document. For dated references, 
subsequent amendments to, or revisions of, any of these publications do not apply. For 
undated references, the latest edition of the normative document referred to applies. 

OGC 01-068r3, Web Map Service Implementation Specification, 1.1.1, 2002-01-16, 
http://www.opengeospatial.org/standards/wms   

OGC 04-094, Web Feature Service Implementation Specification, 1.1.0, 2005-05-03, 
http://www.opengeospatial.org/standards/wfs. 

OGC 06-009r6, OpenGIS Sensor Observation Service, 1.0, 2007-10-26, 
http://www.opengeospatial.org/standards/sos. 

OGC 06-042, OpenGIS Web Map Service (WMS) Implementation Specification, 1.3.0, 
2006-03-15, http://www.opengeospatial.org/standards/wms. 

.OGC 07-022r1, Observations and Measurements – Part 1 - Observation schema 1.0, 
2007-12-08 http://portal.opengeospatial.org/files/?artifact_id=22466. 

OGC 07-036 OpenGIS Geography Markup Language (GML) Encoding Standard, 
3.2.1, 2007-08-27, http://portal.opengeospatial.org/files/?artifact_id=20509. 

http://www.opengeospatial.org/standards/wms
http://www.opengeospatial.org/standards/wms
http://portal.opengeospatial.org/files/?artifact_id=20509


O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  3 
 

OGC 09-001, OpenGIS SWE Service Model Implementation Standard, 2009-09-30. 

OGC 09-025r1 and ISO/DIS 19142, OpenGIS Web Feature Service 2.0 Interface 
Standard, 2010-11-02, http://www.opengeospatial.org/standards/wfs 

OGC 10-037, OGC SOS 2 Interface Standard, 2010-09-02, 
http://www.opengeospatial.org/standards/sos   

OGC 10-037, OGC SOS 2 Interface Standard, 2010-09-02, 
http://www.opengeospatial.org/standards/sos . 

OGC 10-126r1, OGC® WaterML2.0: An O&M profile for water observations data, 

2010-05-27. 
 

*OGC 10-004r2 and ISO/DIS 19156, Geographic information - Observations and 
measurements,2010-05-03. 

 

OGC 10-025r1, *.  
 
ITU-T X.891, SERIES X: DATA NETWORKS, OPEN SYSTEM 
COMMUNICATIONS AND SECURITY, Information technology – Generic 

applications of ASN.1: Fast infoset, 05/2005; http://www.itu.int/ITU-
T/asn1/xml/finf.htm 

3 TERMS AND DEFINITIONS 

For the purposes of this report, the definitions specified in Clause 4 of the OWS 

Common Implementation Specification [OGC 06-121r3], clause 4 of Sensor 
Observation Service [OGC 06-009r6], and Clause 4 of Observations and Measurements 
– Part 1 [OGC 07-022r1]. 

4 CONVENTIONS 

4.1 `Abbreviated terms 

API      Application Programming Interface 

CSIRO   Australian Commonwealth Scientific and Research Organization 

CUAHSI Consortium of Universities for the Advancement of Hydrologic 
Science 

DMZ   De-Militarized Zone 

FI    FastInfoset 

FOI    Feature of Interest 

GSC   Geological Survey of Canada 

GML    Geography Markup Language 

GTN-R   Global Terrestrial Network for River Discharge 

GW IE   OGC Groundwater Interoperability Experiment 

http://www.opengeospatial.org/standards/wfs
http://www.opengeospatial.org/standards/sos
http://www.opengeospatial.org/standards/sos


O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

4 Copyright © 2012 Open Geospati al Consortium  
 

GWML   Groundwater Markup Language 

HDWG   OGC Hydrology Domain Working Group 

IE    Interoperability Experiment 

ISO       International Organization for Standardization 

KML   Keyhole Markup Language 

KiTSM   KISTERS Time Series Server 

KiWIS   KISTERS Web Interoperability Solution 

NCSA   National Center for Supercomputing Applications, U Illinois Urbana 

NWS   National Weather Service 

OGC     Open Geospatial Consortium 

OWS    OGC Web Services 

O&M    Observations and Measurements 

PI    Delft-FEWS Published Interface 

SHEF   Standard Hydrologic Exchange Format 

SOS    Sensor Observation Service 

SWE    Sensor Web Enablement 

UML    Unified Modeling Language 

USGS   US Geological Survey 

WaterML 2   Water Markup Language  

WISKI   Water Information System KISTERS  

WMC   Web Mapping Context 

WMS    Web Mapping Service 

WFS    Web Feature Service 

XML    eXtensible Markup Language 

XSD   XML Schema Definition 

 

4.2 UML notation 

Class diagrams that appear in this report are presented using the Unified Modeling 

Language (UML) static structure diagram, as described in Subclause 5.2 of [OGC 06-
121r3] 

  



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  5 
 

5 SWIE OVERVIEW 

5.1 Background 

The Surface Water IE takes place as an experiment conducted by the OGC Hydrology 
Domain Working group as part of its efforts to advance interoperability with hydrology 
domain application of OGC standards. It is the second experiment conducted  by the 
working group, following the Ground Water IE.  

The experiment is limited in scope to surface water flow observations. The reason is 
that time series of flow observations are typical of a broader range of in-situ 
hydrological observations such as turbidity, electrical conductivity and are very 

common in the hydrology domain. This allowed the experiment to focus on ensuring 
that the characteristics of those time series are tested for suitability with WaterML 2.0, 

without making excessive demands on data providers and limiting unnecessary 
complexity. 

5.2 Motivation and Goals 

This interoperability experiment was designed to advance the development of 

WaterML 2.0, test its use with various OGC service standards (SOS, WFS, WMS and 
CSW) and emerging clients . 

 

Objectives 

Therefore the aim of this IE was to: 

(1) Extend and complement the work already underway in IE 1, with the goal of 
advancing the development of WaterML 2.0 to the sub domain of surface water 
observations. 

(2) Test compatibility of WaterML 2.0 with existing IOW-Sandre, DLZ-IT BMVBS, 
CUAHSI and USGS services and with implementation of the OGC SOS, WFS, WMS 
standards; 

(3) Advance exchange of surface water data between Germany and France in the cross -
border area of the Rhine/Rhin river, such that participants can dynamically and 

transparently access the data and utilize it with their respective information systems.  

(4) Test compatibility of WaterML 2.0 for use with hydrological forecasting systems. 

(5) Establish a limited surface water feature model and vocabularies suitable for the 
provision of surface water data using WaterML 2.0. 

(6) The data will be served by all participants using WaterML 2.0 and OGC services 
(SOS, WFS, WMS). 

 

The experiment was conducted as a set of 3 use cases. The use cases were: 

 

1. Cross Border Data Exchange Use Case: In this use case the user will discover 
surface water data from cross border or other regions via web map client and 

then visualize the time-series. Once the data has been inspected and the user is 



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

6 Copyright © 2012 Open Geospati al Consortium  
 

satisfied that the data is of interest, the user will download the data in an 
appropriate format. 

2. Forecasting Use Case: The user will discover and download data suitable for a 
stream flow forecast. The user will be able to feed a stream flow forecast model 
with this data, but the modeling itself is not part of the scope of this IE. 

3. Global Runoff Use Case: The goal for this use case is to provide automated 
monthly and yearly volume calculations from large rivers discharging to the 
oceans.  Due to slower than expected progress, the use case was amended to a 

simple to a use case very similar to use case 1, in which data from the GRDC 
was made available using WaterML 2.0.  

The original activity plan use cases can be seen in Appendix 2. 

5.3 Structure of Report. 

The following sections report on the use cases of the experiment, each of which is 

broken down into a list of use case contributors, use case description and goal, followed 
by a description of the implementation followed by the results in the form of 
recommendations for best practice and conclusions. This section is followed a report on 

the clients developed as part of the experiment. This allows the findings of the client 
implementation to be reported on separately as there was considerable interest in the 
development of clients as part of the IE. 

  



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  7 
 

6 USE CAS E 1 – CROSS BORDER DATA EXCHANGE 

6.1 Contributors 

Role Contributor 

SOS service implementer Kisters (Germany) 

SOS service implementer 52° North (Germany) 

Data provider Office International de ‘Eau – Sandre (France) 

Project coordination 

Data provider 

Service Centre Information Technology of the BMVBS 

(Germany) 

Project coordination disy Informationssysteme GmbH (Germany) 

Table 1: Contributors for Use Case 1  

6.2 Introduction 

The purpose of use case 1 was to test WaterML 2.0 by disseminating surfacewater flow 
observations of the river Rhine (French: Rhin – German: Rhein) between Germany, the 

Netherlands and France, to all participants using OGC SOS, WFS and WMS web 
services. An additional aim was the demonstration of cross border surface water data 
interoperability in a field with different administrational responsibilit ies with expected 
multilingual issues. 

For the use case, data from France and Germany was to be displayed in a single client, 
with data services from the respective jurisdictions. The targeted clients were the web 
client from 52north and the WISKI client. The proposed SOS implementations were the 
SOS server from 52north and the SOS server component of the KiWIS package. 

6.3 Motivation and Goals  

The cross-border experiment has the following objectives: 

(1) Advancing the development of WaterML 2.0 to the sub domain of surface water 
observations. 

(2) Test compatibility of WaterML 2.0 with existing IOW-Sandre, DLZ-IT services 
and with implementation of the OGC SOS, WFS and WMS standards. 

(3) Advance exchange of surface water data between Germany and France in the 
cross border area of the river Rhine, such that participants can dynamically and 
transparently access the data and utilize it with their respective information 
systems. 

 

 



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

8 Copyright © 2012 Open Geospati al Consortium  
 

6.4 Design and Implementation 

The setup of the cross border experiment included several server implementations of 
WaterML2.0 using SOS, WFS and WMS as well as clients able to consume 
WaterML2.0 data. 

A schematic overview of technology and data sources as well as the role of the 
participants is shown in the figure below. Initially the experiment planned to use a 
simple setup with service endpoints known to the participants (see SOS implementation 

in Figure 1). Later in the experiment it was planned to use catalogue services (see CSW 
implementation in Figure 1 below) for the service and data discovery. 

 

Figure 1: schematic overview of technology and data sources  

6.5 Results - outstanding issues 

Unfortunately as the experiment progressed, the supply of data from the necessary 

institutions to support the IE became a problem. On the French side this lack of data 
made it difficult to set up an infrastructure in the planned area, which could be used for 

the IE. In addition, the German data source was only providing the last four weeks of 
observation data. As well, only data for some stations in other catchment areas were 
available late in the experiment, so that a combined view on the data would have been 
quite meaningless. 

The problem of missing data from one of the participants was not due to the lack of 
willingness to contribute to the IE, but on the fact, that the central database of the 
French hydrological service was undergoing a major redesign, which delayed the 

implementation of a real-time or near real-time data exchange. Office International de 
l’Eau was able to put online data on the Rhine river catchment late in the process : 



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  9 
 

November 2011 (values start around the end of September 2011) and July 2012. Before 
that, test data was available on other French areas to validate the architecture. 

The Sandre SOS endpoint used for the experiment was: 
http://services.sandre.eaufrance.fr/52nSOSv3_WML/sos 

For further interoperability experiments it should be considered to have a reasonably 
good knowledge of the existing and accessible data.  

The other issue experienced concerns the rapid development of the underlying  

specifications SOS 2.0 and WaterML 2.0. Due to the frequent changes in these two 
specifications, the ability of the software providers to implement and provide 
consolidated implementations of client and server where very limited. 

6.6 Recommendations: 

6.6.1 SOS & OM usage 

The work done helped provide feedbacks on :  

 the drawbacks of SOS 1.0 getCapabilities (listing all fOI) and offerings, 
 best practice on how to use the OM_Process / procedures (process type VS 

process instance). 

This issue is dealt with in detail in use case 3 and chapter 9. 

6.6.2 Organizational recomendation 

Due to the organizational difficulties related to data availability experienced during this 
use case, it is recommended that for future experiments, contributors , put time into to 
identifying these organizational barriers as risks, and develop appropriate risk 
management strategies. 

R1: Future experiments, contributors, put time into to identifying organizational 
barriers as risks to experiments, and develop appropriate risk management 
strategies. 

  



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

10 Copyright © 2012 Open Geospati al Consortium  
 

7 USE CAS E 2 - FORECASTING 

7.1 Contributors 

Role Contributor 

SOS service  USGS, KISTERS 

SOS client  Deltares & NOAA/NW S, KISTERS 

 

7.2 Introduction 

This use case looks at the suitability of WaterML 2.0 encoding, delivered using SOS, 
for incremental feeds of hydrological (time series) data, in real time, from known data 

sources, to hydrological forecasting systems. This experiment will not address the 
delivery of hydrological forecasts via an SOS, as this evaluation is foreseen fo r the 
follow on interoperability experiment focused on Hydrological Forecasting. 

7.3 Motivation and Goals 

Hydrologic forecasting applications are real time system applications that continuously 
need to be aware of the latest state of the water and weather systems. Their data feed 
process is characterized by a incremental data ingest occurring at relative high 

frequency (1-15 minutes). The record lengths of data transmitted are typically small 
(i.e. one or a few values per observation). However, given the real t ime aspect of these 

systems with high frequency update requirements , they need to be efficient with their 
data feed as well. This places different requirements on the data encoding and services 
compared to the other use cases. 

These requirements are characterized by the high-frequent exchange of data increments 

from a known set of monitoring points for a known set of phenomena. The exchange 
needs to be fast, so that it disrupts the forecast system as little as possible. Data 
discovery is typically not relevant in this context, and meta-data therefore, should be 
kept to a minimum to reduce the payload and parsing time. 

The goal of this use case is to evaluate the suitability of SOS and the WaterML 2.0 
encoding to support high-performance forecasting systems with high frequency, 
incremental observational data updates. In this evaluation, a comparison is made 

against other standardized file formats that are commonly used to exchange 
hydrometeorologic time series for forecasting purposes: 

7.4 Design and Implementation 

To assess the performance of WaterML 2.0 encoded files, a comparison is made against 

other standardized file formats that are commonly used to exchange hydrometeorologic 
time series for forecasting: 

• SHEF: The US - Standard Hydrometeorological Exchange Format 



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  11 
 

• PI-xml: the Published Interface format from the Delft-Flood Early 
Warning System 

The following evaluation criteria have been applied: 

• ingest time 

• file size (compressed/uncompressed) as a proxy for network transportation 

The SOS 2.0 service used to deliver the data was hosted by USGS  
(http://http://nwisvaws02.er.usgs.gov/ogc-swie/). Some other tests have been done with 
a SOS 1.0 service using SWE Common encoding, hosted by 52North. 

Deltares implemented the SOS client in the Delft-FEWS software platform. The test 

application was the NCRFC-CHPS (North Central River Forecasting Center's 
implementation of the Community Hydrologic Prediction System (CHPS)). 

Ingest time was evaluated from the moment of receiving the SOS-response message to 
the internal data commit for WaterML2 encoded data. From this data set, a set of SHEF 

and PI-xml files were created and posted to the local disk. These files were then read 
from disk. For these two formats, ingest time was calculated from the start of file read 
to internal data commit. 

7.5 Results – outstanding issues 

Having a clear and shared agreement on the SOS-profile is essential for forecasting 
systems, as these applications are not designed to discover data or figure out by 
themselves how to query a service. Their purpose is to bring in the data as fast as 

possible. While FeatureOfInterest and ObservedProperty are rather clear, the use of 
Offerings and Procedures leaves too much room for mixing one and the other. 

Metadata is burdening the performance of xml-encoded WaterML2 messages in high-
frequent incremental data exchange. The overhead in a WaterML2 encoded message is 

5-10 times the overhead in SHEF and PI-formats. This is reflected both in message size 
as well as ingest time. The relative overhead shrinks with longer timeseries, but those 

are not typical within a forecasting context. Reduction of nested data structure 
complexity is likely to contribute to better performance.  It is recognized that both 
SHEF and PI-xml are highly optimized formats for specific data and uses, and we can 

expect them to out perform a generalized data format such as WaterML 2.0 and how 
efficient WaterML 2.0 needs to be for forecasting applications remains an open 
question. There are a number of options available to assess; profiling WaterML 2.0 in a 

“simple profile” which limits the amount of metadata transmitted, binary xml encoding 
such as FastInfoset (FI) and full xml compression using gzip or similar. 

NWS and USGS use different identifiers for the same stations. An Identification 
Mapping service (ID Mapping) would be highly desirable to accommodate the mixed 
usage of station identifiers from either organization (and others).   

 

http://http/nwisvaws02.er.usgs.gov/ogc-swie/


O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

12 Copyright © 2012 Open Geospati al Consortium  
 

7.6 Recommendations 

7.6.1 Services Profile 

SWIE-compliant SOS-services need to be clear on the interpretation of the terms 
'Offering' and 'Procedure'. Currently too much variation exists between services that 
use these items.  

This issue is dealt with in detail in use case 3. 

One of the other issues that arose during the IE was that WaterML2.0 requires GML 

3.2, and SOS2.0. At the time of the IE, SOS2.0 was still under development, and the 
specification was not available for implementation. The IE, therefore, initially used 
SOS 1.0 for the SWIE. This recommendation is located in 9.3 SWIE SOS hydrology 
profile. 

7.6.2 Issues and Recommendations 

R2: Any reduction of metadata transmission will be beneficial for incremental 

high frequency data exchange. 

R3: Additional research will be needed to evaluate to assess if binary encodings 

can overcome some of the poor performance problems from WaterML2 in full 

xml-encoding.  

  



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  13 
 

8 USE CAS E 3 – GLOBAL RUNOFF 

8.1 Contributors 

Role Contributor 

SOS Services KISTERS 

SOS Client  KISTERS 

Data Provider GRDC 

Data Provider USGS 

Service Provider USGS 

Table 2: Contributors for Use Case 3.  

8.2 Introduction 

The original plan for this use case was to provide calculated monthly and yearly volum e 

discharge estimates from a few large rivers discharging to the oceans. This was an am bitious 

plan in which processing tasks were to be included as part of a workflow that would totalize the 

discharge measurement for a selected year an d then display aggregated values.  Candidate  

locations for the experiment were to be selected from the Global Runoff Data Center (GRDC)  
database.  

The plan was adjusted durin g the experiment as a result of the slower than expected progress 

due to the difficulties with developing services concurrently with the WaterML2.0 
development. The original plan for this use case can be seen in Appendix 2. 

8.3 Motivation and Goals  

The goal of the use case was adjusted to two tasks: 

(1) to make data from the GTN-R Station network provided by Global Runoff Data 
Center available using WaterML2 and SOS and 

(2)  to enable the GRDC to ingest data from the USGS (Mississippi Area) using 
WaterML2 and SOS. 

8.4 Design and Implementation 

The implementation was based on establishing an instance of the KISTERS 
WISKI/KiTSM to provide the underlying data repository for the GRDC data. This was 
setup by KISTERS within the KISTERS DMZ for the purpose of the experiment. 

The GRDC data was migrated into this data management system but required some 
modification to support delivery by WaterML2.0. The data was extended to include 
gauge name, WMO gauge identifier, country the gauge is in, time zone information and 
spatial references as well as the WMO catchment name and associated size. 

On top of the WISKI/KiTSM system the KISTERS Interoperability Solution KiWIS 
provided the support for SOS/WaterML2.0 (http://kiwis.kisters.de).  

http://kiwis.kisters.de/


O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

14 Copyright © 2012 Open Geospati al Consortium  
 

The WISKI Desktop application was also extended to consume metadata and time 
series data through new SOS consumer classes. For this use case, a dedicated consumer 
class has been developed to ingest data from the USGS NWIS Services  which can be 
found at http://nwisvaws02.er.usgs.gov/ogc-swie/. 

The diagram below shows the architecture of the system for use case 3. 

 

 

Figure 2: Architecture of the system for use case 3  

8.5 USGS SOS Services 

The experimental WaterML 2.0 service created by the United States Geological Survey 
(USGS) provided runoff data from the Mississippi to GRDC. USGS had an additional 
goal to evaluate how feasible it would be to serve hydrological time series data from the 
entire United States using WaterML 2.0.  

This service was built to deliver WaterML 2.0 using initially SOS1.0 as required by 
SWIE. It was able to offer a GetCapabilities, DescribeSensor, GetDataAvailablity, and 
GetObservation output for all of the real-time water data that is available in the USGS 

National Water Information System (NWIS), as well as historic daily data.  Discharge, 
gage height, temperature, precipitation, dissolved oxygen, turbidity, and pH were the 

properties that were specifically tested, although all properties are available using a 5-
digit parameter code.  A very elementary WebFeatureService (wfs) was also provided. 
 GetObservation data using WaterML 2.0 was the main output being investigated.  The 

service is available here: http://nwisvaws02.er.usgs.gov/ogc-swie/.  It will continue to 
evolve with the changing WaterML 2.0 requirements. 

 

8.6 USGS SOS Service Results 

During the Surface Water Interoperability Experiment (SWIE), the experiences of 
creating and using this service contributed to a number of changes made in the 

http://nwisvaws02.er.usgs.gov/ogc-swie/
http://nwisvaws02.er.usgs.gov/ogc-swie/


O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  15 
 

WaterML 2.0 requirements.  For example, there were several fields in the WaterML 2.0 
specification document that had very limited output options.  These were typically not 
appropriate for USGS needs (there are certain qualifiers and phrases that must be 
included in USGS data by law).   

Another outcome of the creating the test service was to analyze how WaterML 2.0 
could handle non-standard cases.  Multiple sensors at a single location, variable depths, 
and unique conditions (ice, adjusted values, etc.) were found and discussed within the 
WaterML 2.0 standards working group. 

An additional important aspect of the USGS service was dealing with huge amounts of 
data.  Aside from simply serving WaterML2 time series data, we attempted to provide a 
complete SOS 2.0 service.  A requirement for SOS 2.0 is a complete GetCapabilities 

document.  This document should theoretically give information about all of the 
possible offerings of the service.  Since the USGS service covers the entire United 

States, there was no way to include all of that information.  We followed the general 
guidelines developed by Kisters using their SOS Type C implementation described 
above.  Using the Type C implementation made it possible to provide a complete SOS 

service, but we still found the data discovery to be lacking.  Eventually we 
implemented a SOS 2.0 optional extension called GetDataAvailability.  This was a very 
useful and powerful extension.  A user can request information on featureID’s, 

properties, offerings, and time periods.  For example, a user could ask what featureID’s 
have certain unique properties and/or offerings during a specific time period.  Another 

example might be what properties are measured at a certain featureID and over what 
time period. 

  



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

16 Copyright © 2012 Open Geospati al Consortium  
 

 

9 RESULTS AND  OUTSTANDING ISSUES 

The IE has contributed to the goal of further advancing WaterML2.0, which was the 
primary objective. The project teams have worked closely with the WaterML2.0 design 
team relating experiences that could be included into the design considerations. As 

indicated earlier, this has been both advantageous – being able to quickly react to issues 
as they arose, but also a hindrance, as the services relied on having a relatively fixed 
standard to work with. 

9.1 SOS Version 

As SOS 2.0 is still under development a decision was made to use SOS 1.0 which 
specifies the use of GML3.1.1, despite WaterML2.0 requiring GML3.2. This was 
reported on in 7.6.1.   

The USGS was able to build a prototype SOS2.0 service during the experiment, and 
some experience with WaterML2.0 and SOS2.0 was obtained. 

Further investigation is needed on the compatibility of the SOS1.0 and SOS2.0 
implementations. 

9.2 SOS Usage 

The SOS 1 specification requires that the list of features-of-interest be explicitly 

serialized in the GetCapabilities document. This list is either used for discovery 
(harvesting by catalog) or to provide a valid list of feature identifiers  to be used in 

GetObservation (the feature-of-interest id being one of the parameters of this 
operation). 

The SOS 2 draft specification includes a relatedFeature property for the observation(no 

more information is provided, beside the property cardinality in Table 17 of OGC 10-
037), which seems to play a slightly more restricted role.  

The Capabilities document of SOS 2.0 lists related features instead of all features-of-
interest. The related features are selected by the service provider and serve discovery 
purposes. 

In the current WaterML2.0 model, it has been decided that the feature-of-interest 
should be constrained to a WaterML2.0 sampling feature and some systems can contain 

large quantities of features-of-interest, so it is impractical for performance reasons to 
serialize them individually.   

Nonetheless, the service is still required to publish a collection of feature-of-interest 
that can be used in GetObservation requests to extract observations related to a specific 
feature-of-interest. 

9.2.1 Proposed Solution  

We propose that the profile element SOS2.0 be formally part of the SOS specification. 
The capabilities document should be allowed to provide a composite feature as feature-

of-interest. The composite feature shall be a gml:FeatureCollection nesting other 

http://external.opengis.org/twiki_public/bin/view/HydrologyDWG/GetCapabilities


O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  17 
 

gml:FeatureCollections. The collection would be composed of a list of sub-collections. 
If the sub-collection contains a reasonable amount of features -of-interest, the list would 
be serialized explicitly; otherwise the composite feature is serialized. The nesting logic 

within collections is up to the server. It can follow a purely geometric partitioning (e.g. 
quad-tree) or follow an administrative structure (state/county/city/zip).  

 

9.3 SWIE SOS Hydrology Profile 

9.3.1 Overview 

Experience with the existing SOS services shows that there is a range of ways to 
understand the generic SOS terminology. In different domain implementation areas 

the SOS standards have been interpreted differently and this has led to different 
implementations. These different SOS implementations cause ambiguous 
client/server interactions that are syntactically correct but create a semantically 

incorrect request/response patterns.  

 

To ensure consistent interpretation a common process of development or 
“alignment” is required typical of which you will find in an OGC IE.  

 

This is because SOS (and many other OGC standards) is an abstract specification 
designed to support a broad range of use cases ranging from fixed in-situ sensors to 

tracking applications or even complex remote sensing systems. Thus, flexibility is 
absolutely necessary to accomplish this. It is therefore up to the application domain 

to specialise the abstract standards suitable for implementation. 

In this chapter we therefore propose a specialisation of SOS usage (with respect to 
the WaterML2 proposal) – a profile for use in the IE. It should be seen as a “SOS 

Usage Profile for the Hydrology Domain” to which data providers and data 
consumer in the hydrological world can agree and comply with their software 

systems. This is necessary because just “SOS compliance” will not ensure that the 
client knows how the specific server understands the main SOS terms (“procedure”, 
“observed property”, “feature of interest”, “offering”). 

 

It is worth noting that this profile has been developed using SOS 1.0 and will 

possibly need to be extended or adjusted for use by SOS 2.0. 

9.3.2 Definitions 

General definitions as taken from the SOS 1.0 and O&M 1.0 specification 
documents: 

 

Observation Offering: 

An observation offering is a logical grouping of observations offered by a service 
that are related in some way. The parameters that constrain the offering should be 



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

18 Copyright © 2012 Open Geospati al Consortium  
 

defined in such as way that the offering is 'dense' in the sense that requests for 
observations that are within the specified parameters should be unlikely to result in 
an empty set. 

 

Procedure: 

Method, algorithm or instrument. (O&M: ...which is often an instrument or sensor 
but may be a process chain, human observer, an algorithm, a computation or 

simulator.) 

ObservedProperty: 

The observedProperty identifies or describes the phenomenon for which the 
observation result provides an estimate of its value. It must be a property associated 
with the type of the feature of interest. 

 

FeatureOfInterest: 

The featureOfInterest is a feature of any type (ISO 19109, ISO 19101), which is a 
representation of the observation target, being the real-world object regarding which 

the observation is made. 

9.3.3 Analysis 

This section contains the analysis of different SOS types that have been 
implemented in different domains. The objective is to try and assess which type is 
better suited to the needs of the hydrology domain. 

1. SOS Server Type A (procedure == sensor-type) 

 

A SOS service which serves more than raw data or medium/larger networks should 
use the following structure for the getCapabilities response – A procedure is seen as 
a sensor-type (==time-series type) and NOT as a sensor instance (==time-series 

instance). This structure should be homogenously used and not be used with other 
encodings. 

Example: 
http://kiwis.kisters.de/KiWIS/KiWIS?service=SOS&request=getCapabilities&datas
ource=0 

 

2. SOS Server Type B (procedure == sensor-instance) 

 

A SOS service which is a bit more as originally intended by SOS specification 

should use the following structure for the getCapabilities response - A procedure is 
seen as a sensor-instance (==complete identification of a single timeseries) . This 
structure encodes a path into the procedure field but allows inconsistent requests 

with features and properties. 

Example: 

http://kiwis.kisters.de/KiWIS/KiWIS?service=SOS&request=getCapabilities&datas
ource=1 

http://kiwis.kisters.de/KiWIS/KiWIS?service=SOS&request=getCapabilities&datasource=0
http://kiwis.kisters.de/KiWIS/KiWIS?service=SOS&request=getCapabilities&datasource=0
http://kiwis.kisters.de/KiWIS/KiWIS?service=SOS&request=getCapabilities&datasource=1
http://kiwis.kisters.de/KiWIS/KiWIS?service=SOS&request=getCapabilities&datasource=1


O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  19 
 

 

3. SOS Server Type C (procedure==sensor-type/system) 

 

A SOS as intended by the GroundWater IE should use the following structure for the 

getCapabilities response - A procedure is seen as a sensor-type or system. This 
structure requires additional requests or knowledge to “drill” into the data if you 
want to do it by sensor instance. Also refer to: 

http://external.opengis.org/twiki_public/bin/view/HydrologyDWG/GwIeGetCapabili
tiesBestPractices,  

http://external.opengis.org/twiki_public/bin/view/HydrologyDWG/SOSLargeCollect
ionSensorDiscussion) 

Example: 

http://kiwis.kisters.de/KiWIS/KiWIS?service=SOS&request=getCapabilities&datas
ource=2 

 

4. SOS Server Type D “MIXED” (procedure==sensor-instance AND derived 
timeseries type) 

 

In addition to all types above there is also the option to use everything together in a 
“MIXED” way. A procedure is seen as a sensor-instance or a derived timeseries 
type. In this way actual sensor timeseries and derived timeseries can be 

distinguished. There is one procedure, one relatedFeature and one observedProperty 
per offering as long as there are different properties. This is a clear language but it 

results in very large getCapabilities documents. 
 

Also refer to: 

https://wiki.csiro.au/confluence/display/WaterML20/Adapting+to+SOS+(2.0) 

 

With reference to tables in Appendix 1, which describe the size of a GetCapabilities 
document for the different implementation options, we find that the document size 
consists of: 

- A couple of lines for the ServiceIdentification / ServiceProvider sections 

- Variable lines depending on the amount of FOI 

- Variable lines for Procedure 

- A rough estimate of 55-75 Bytes per line 

 

It was found that, depending on the SOS service type, the size is document size 
grows exponentially. At the HydroDWG workshop on Sept, 21

st
 2010, at the 

Toulouse TC, it was sensibly decided that the GetCapabilities document for the IE 
should be a quick handshake document and not a full listing of database content (that 
just excludes the time-series values and some metadata from the full description).  

http://external.opengis.org/twiki_public/bin/view/HydrologyDWG/GwIeGetCapabilitiesBestPractices
http://external.opengis.org/twiki_public/bin/view/HydrologyDWG/GwIeGetCapabilitiesBestPractices
http://external.opengis.org/twiki_public/bin/view/HydrologyDWG/SOSLargeCollectionSensorDiscussion
http://external.opengis.org/twiki_public/bin/view/HydrologyDWG/SOSLargeCollectionSensorDiscussion
http://kiwis.kisters.de/KiWIS/KiWIS?service=SOS&request=getCapabilities&datasource=2
http://kiwis.kisters.de/KiWIS/KiWIS?service=SOS&request=getCapabilities&datasource=2
https://wiki.csiro.au/confluence/display/WaterML20/Adapting+to+SOS+(2.0)


O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

20 Copyright © 2012 Open Geospati al Consortium  
 

The consequence of this was that only the network itself was advertised, with the 
clients then required to further query the SOS with GetFeatureOfInterest calls with a 
filter query specification to return the sampling points of interest. This approach is 

practical but semantically inconsistent as the feature of interest changes from the 
network in GetCapabilities to SamplingPoints in the GetFeatureOfInterest. 

 

9.3.4 Recommendation 

Based on discussions held as part of the IE and the above analysis there are several 
problems that have to addressed to achieve interoperability. The biggest discrepancy 

lies with the interpretation of the normative definitions of O&M (for example, what 
is the featureofinterest)  

Most database and timeseries management system architectures require a unique 
identification of timeseries, which in SOS must be accomplished by suitable 

mapping between system definitions of this information items and O&M. 

Further issues include that the SOS definition by default allows large bulk requests 

for data (e.g. complete data of all timeseries for one property) and the usage of the 
featureOfInterest in form of a real world feature like a river does not enable you to 
request data of a specific station, which requires some constraint of the feature of 

interest. 

 

Therefore the following set of rules has been agreed on to provide an interoperable 
SOS profile for the SurfaceWaterIE 

 

9.3.5 SWIE WaterML 2 Profile 

1. SWIE-compliant SOS services shall use the SOS 1.0 specification, even if the 
resulting Observation collection is GML 3.2. 

 
2. SWIE-compliant SOS services shall use the procedure as sensor or algorithm 

type like described in Type C, not as instance.  

 
3. SWIE-compliant SOS services shall use the featureOfInterest as 

samplingFeature in the sense of a site or station, not as the actual observed 
object (e.g. a river). This is consistent with WaterML2.0. 
 

4. SWIE-compliant SOS services shall use a global featureOfInterest in the 
GetCapabilities document and not list all existing samplingFeatures. 
 

5. SWIE-compliant SOS services shall use a mandatory GetFeatureOfInterest 
request to identify actual samplingFeatures either by filters or as complete list 

based on the global featureOfInterst. 
 



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  21 
 

6. SWIE-compliant SOS services shall use a GetObservation request that either 
answers the full amount of data requested, or with an appropriate error message 
if the service provider wants to prevent large bulk requests. 

 
7. SWIE Should use the profile element in SOS2 to announce a SWIE/Type C 

SOS 

  



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

22 Copyright © 2012 Open Geospati al Consortium  
 

10 SW IE CLIENT IMPLEMENTATION  

10.1 DelftFEWS SOS Client – Deltares 

10.1.1  Motivation and goals 

As a major supplier of forecasting system applications based on its Delft -FEWS software 

platform, Deltares would like to contribute to a WaterML2 standard that is suitable for 

hydrologic forecasting. As such the first  step is to evaluate the suitability of  SOS-services 
and WaterML2 encodings as a data feed to a forecasting system.  

To enable this evaluation, Deltares implemented a SOS client in the Delft -FEWS software 

platform. The test application was the NCRFC-CHP S (North Central River Forecasting 
Center's application of the Community Hydrologic Prediction System (CHPS)).  

10.1.2  Design and Implementation 

Forecasting agencies rely on data feeds they trust. These data feeds change infrequently,  

data discovery needs are infrequent and often require action by the user (i.e. configuration). 

Given this context, Delft -FEWS requires the customization of the SOS client to query a 

specific SOS-service for the observations within a moving time windo w for a specific set of 

features of interest, observed property(s) and, if required by the service, offering and 

procedure. The variability in the usage of offering and procedure by SOS services makes it  
hard to setup these clients. 

After implementation of the SOS client and customization for a data feed from USGS, a set 

of observations (with 15 minute interval) was retrieved for a 1 -day period and a 10-day 

period. Ingest t imes were derived. The data sets were exported to local disk in two other file 

formats for comparison: SHEF.E and PI-xml file format. 

10.1.3  Results  

Belo w, three data samples are displayed, all providing 8 observation values with a 15 -

minute interval for the Escanaba River at Cornell, MI (NWS id CRNM4, USGS id 
04059000). 

In SHEF, the US - Standard Hydrometeorological Data Exchange Format, it  looks like: 

: Date/time forecast: 20110415 

.ER CRNM4 20110413 Z DH06/DC201104161002/STG    /DIN15 

.E1    405.00/  403.00/  403.00/  404.00/  405.00/  404.00/  404.00/  403.00/ 

PI-xml, the Deltares FEWS Published Interface encoding looks like: 

<?xml version="1.0" encoding="UTF-8"?> 

<TimeSeries xmlns="http://www.wldelft.nl/fews/PI" 

xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 

xsi:schemaLocation="http://www.wldelft.nl/fews/PI 

http://fews.wldelft.nl/schemas/version1.0/pi-schemas/pi_timeseries.xsd" 

version="1.2"> 

    <timeZone>0.0</timeZone> 

    <series> 

        <header> 

            <type>instantaneous</type> 

http://fews.wldelft.nl/schemas/version1.0/pi-schemas/pi_timeseries.xsd


O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  23 
 

            <locationId>CRNM4</locationId> 

            <parameterId>STG</parameterId> 

            <timeStep unit="nonequidistant"/> 

            <startDate date="2011-04-13" time="06:00:00"/> 

            <endDate date="2011-04-15" time="06:00:00"/> 

            <missVal>-999.0</missVal> 

            <stationName>Cornell</stationName> 

            <units>M</units> 

        </header> 

        <event date="2011-04-13" time="06:00:00" value="405.0" flag="0"/> 

        <event date="2011-04-13" time="06:15:00" value="403.0" flag="0"/> 

        <event date="2011-04-13" time="06:30:00" value="403.0" flag="0"/> 

        <event date="2011-04-13" time="06:45:00" value="404.0" flag="0"/> 

        <event date="2011-04-13" time="07:00:00" value="405.0" flag="0"/> 

        <event date="2011-04-13" time="07:15:00" value="404.0" flag="0"/> 

        <event date="2011-04-13" time="07:30:00" value="404.0" flag="0"/> 

        <event date="2011-04-13" time="07:45:00" value="403.0" flag="0"/> 

 

The associated WaterML2 encoding (same station, discharge instead of stage) looks like:  

<wml2:TimeseriesObservation xmlns:gml="http://www.opengis.net/gml/3.2" 

    xmlns:om="http://www.opengis.net/om/2.0" 

xmlns:sa="http://www.opengis.net/sampling/2.0" 

    xmlns:swe="http://www.opengis.net/swe/2.0" 

xmlns:xlink="http://www.w3.org/1999/xlink" 

    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 

    xmlns:wml2="http://www.opengis.net/waterml/2.0" 

xmlns:gmd="http://www.isotc211.org/2005/gmd" 

    xmlns:gco="http://www.isotc211.org/2005/gco" 

xmlns:sf="http://www.opengis.net/sampling/2.0" 

    xmlns:sams="http://www.opengis.net/samplingSpatial/2.0" gml:id="USGS" 

    xsi:schemaLocation="http://www.opengis.net/waterml/2.0 ../waterml2.xsd"> 

    <gml:identifier codeSpace="http://nwis.waterdata.usgs.gov/MI/nwis" 

        >USGS.04059000</gml:identifier> 

    <gml:name codeSpace="http://nwis.waterdata.usgs.gov/MI/nwis">ESCANABA RIVER AT 

CORNELL, 

        MI</gml:name> 

    <om:metadata> 

        <wml2:ObservationMetadata> 

            <gmd:contact xlink:href="http://cida.usgs.gov"/> 

            <gmd:dateStamp> 

                <gco:Date>2011-04-15</gco:Date> 

            </gmd:dateStamp> 

            <gmd:identificationInfo xlink:href="urn:OGC:unknown"/> 

            <wml2:status 

xlink:href="http://waterdata.usgs.gov/MI/nwis/help/?provisional"/> 

        </wml2:ObservationMetadata> 

    </om:metadata> 

    <om:phenomenonTime> 

        <gml:TimePeriod gml:id="ts_period"> 

            <gml:beginPosition>2011-04-14T00:00:00-05:00</gml:beginPosition> 

            <gml:endPosition>2011-04-15T03:45:00-05:00</gml:endPosition> 

        </gml:TimePeriod> 

    </om:phenomenonTime> 

    <om:resultTime> 

        <gml:TimeInstant gml:id="result_time"> 

            <gml:timePosition>2011-04-15T05:30:14</gml:timePosition> 

        </gml:TimeInstant> 

    </om:resultTime> 

    <om:procedure xlink:href="http://www.nemi.gov" xlink:title="Discharge"/> 

    <om:observedProperty xlink:href="urn:ogc:def:phenomenon:OGC:Discharge" 

xlink:title="Discharge"/> 

    <om:featureOfInterest> 

        <wml2:MonitoringPoint gml:id="USGS.WMP.04059000"> 



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

24 Copyright © 2012 Open Geospati al Consortium  
 

            <sf:sampledFeature 

                xlink:href="http://nwisvaws02.er.usgs.gov/ogc-

swie/wfs?request=GetFeature&amp;featureId=04059000"/> 

            <sf:parameter> 

                <om:NamedValue> 

                    <om:name xlink:title="Watershed"/> 

                    <om:value>Escanaba</om:value> 

                </om:NamedValue> 

            </sf:parameter> 

            <sams:shape> 

                <gml:Point gml:id="USGS.P.04059000"> 

                    <gml:pos srsName="urn:ogc:def:crs:EPSG:4269">45.90857270 -

87.21374820</gml:pos> 

                </gml:Point> 

            </sams:shape> 

            <wml2:descriptionReference 

                

xlink:href="http://external.opengis.org/twiki_public/bin/view/HydrologyDWG/Surface

waterInteroperabilityExperiment#Use_Case_2" 

                xlink:title="This wiki page describes the IE"/> 

            <wml2:timeZone> 

                <wml2:TimeZone> 

                    <wml2:zoneOffset>-05:00</wml2:zoneOffset> 

                    <wml2:zoneAbbreviation>EST</wml2:zoneAbbreviation> 

                </wml2:TimeZone> 

            </wml2:timeZone> 

        </wml2:MonitoringPoint> 

    </om:featureOfInterest> 

    <om:result> 

        <wml2:owner> 

            <gmd:organisationName> 

                <gmd:CharacterString>Michigan Water Science 

Center</gmd:CharacterString> 

            </gmd:organisationName> 

        </wml2:owner> 

        <wml2:Timeseries gml:id="time_series_loc_0"> 

            <wml2:domainExtent xlink:href="ts_period"> 

                <gml:TimePeriod gml:id="USGS.TP.04059000"> 

                    <gml:beginPosition>2011-04-14T00:00:00-

05:00</gml:beginPosition> 

                    <gml:endPosition>2011-04-15T03:45:00-05:00</gml:endPosition> 

                </gml:TimePeriod> 

            </wml2:domainExtent> 

            <wml2:defaultTimeValuePair> 

                <wml2:TimeValuePair> 

                    <wml2:unitOfMeasure uom="cfs"/> 

                    <wml2:dataType 

                        

xlink:href="http://www.opengis.net/def/timeseriesType/WaterML/2.0/Continuous" 

                        xlink:title="Continuous/Instantaneous"/> 

                    <wml2:qualifier 

xlink:href="http://waterdata.usgs.gov/MI/nwis/help/?provisional" 

                        xlink:title="Provisional data subject to revision."/> 

                </wml2:TimeValuePair> 

            </wml2:defaultTimeValuePair> 

            <wml2:Point> 

                <wml2:TimeValuePair> 

                    <wml2:time>2011-04-15T03:45:00-05:00</wml2:time> 

                    <wml2:value>2860</wml2:value> 

                </wml2:TimeValuePair> 

            </wml2:Point> 

            <wml2:Point> 

                <wml2:TimeValuePair> 

                    <wml2:time>2011-04-15T03:30:00-05:00</wml2:time> 

                    <wml2:value>2860</wml2:value> 

                </wml2:TimeValuePair> 

            </wml2:Point> 

            <wml2:Point> 

                <wml2:TimeValuePair> 

                    <wml2:time>2011-04-15T03:15:00-05:00</wml2:time> 

                    <wml2:value>2860</wml2:value> 

                </wml2:TimeValuePair> 

            </wml2:Point> 

            <wml2:Point> 

                <wml2:TimeValuePair> 



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  25 
 

                    <wml2:time>2011-04-15T03:00:00-05:00</wml2:time> 

                    <wml2:value>2860</wml2:value> 

                </wml2:TimeValuePair> 

            </wml2:Point> 

            <wml2:Point> 

                <wml2:TimeValuePair> 

                    <wml2:time>2011-04-15T02:45:00-05:00</wml2:time> 

                    <wml2:value>2890</wml2:value> 

                </wml2:TimeValuePair> 

            </wml2:Point> 

            <wml2:Point> 

                <wml2:TimeValuePair> 

                    <wml2:time>2011-04-15T02:30:00-05:00</wml2:time> 

                    <wml2:value>2890</wml2:value> 

                </wml2:TimeValuePair> 

            </wml2:Point> 

            <wml2:Point> 

                <wml2:TimeValuePair> 

                    <wml2:time>2011-04-15T02:15:00-05:00</wml2:time> 

                    <wml2:value>2890</wml2:value> 

                </wml2:TimeValuePair> 

            </wml2:Point> 

            <wml2:Point> 

                <wml2:TimeValuePair> 

                    <wml2:time>2011-04-15T02:00:00-05:00</wml2:time> 

                    <wml2:value>2920</wml2:value> 

                </wml2:TimeValuePair> 

            </wml2:Point> 

File  size  (compressed/uncompressed) 

In terms of file size, it  is clear that SHEF (not an xml-based format) is t iny compared 

to PI-xml and WaterML2. PI xml is about half the size of a WaterML2 encoding, but 

the difference becomes less when compressed using a normal zip -algorithm. 

WaterML2 compresses significantly, its compressed file is not much larger than the 
zipped PI-xml file. 

Ingest time. 

The average ingest t ime of the WaterML2 encoded messages for a 1 -day period with 

15 minute interval data, was a factor 3 slower than the same dataset in SHEF and a 

factor 6 slower than the PI-xml encoding. The average ingest t ime per value reduces 

with larger timeseries, but the reduction for the PI-xml and SHEF encoded formats is 
higher than the reduction for WaterML2. 

 Issues 

The above results are from limited experiments only. Due to the ongoing evolvement 

of WaterML2 and the USGS-SOS service, the SOS client was often broken, hindering 

the ability to conduct more experiment



O GC
®
 Surfacewater Interoperability Experiment Final Report O GC 12-018r2 

 

Copyright © 2012 Open Geospati al Consortium  26 
 

 

11 ACKNOWLEDGEMENTS 

The SWIE is grateful for the invaluable guidance provided by the OGC, and for the 
commitment and dedication of SWIE participants. 

 

  



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

Copyright © 2012 Open Geospati al Consortium  27 
 

APPENDIX 1 - GETCAPABILITIES DOCUMENT SIZE 

 

This appendix contains the table of getCapabilities file size with increasing numbers 
of sampling points and phenomena  

Stations/ Sit es/  
FOI 

TS per 
Station  

Lines 

per  
Proc 

Lines 
per FOI 

Lines per 
ObsProp  Lines 

File size  
(kB) 

             

0 (Info onl y)  0 0 0 0 100 4 

1 20 3 2 2 164 7 

10 20 3 2 2 182 9 

100 20 3 2 2 362 20 

1,000 20 3 2 2 2,162 134 

10,000 20 3 2 2 20,162 1,277 

50,000 20 3 2 2 100,162 6,355 

100,000 20 3 2 2 200,162 12,703 

500,000 20 3 2 2 1,000,162 63,484 

1,000,000 20 3 2 2 2,000,162 126,960 

Table 3: GetCapabiliti es filesi ze for SOS A – procedure is sensor type 

 

Stations/ Sit es/  

FOI 

TS per 

Station  

Lines 
per  

Proc 

Lines 

per FOI 

Lines per 

ObsProp  Lines 

File size 

(kB) 

             

0 (Info onl y)  0 0 0 0 100 4 

1 20 3 2 2 164 9 

10 20 3 2 2 722 49 

100 20 3 2 2 6,302 456 

1,000 20 3 2 2 62,102 4,526 

10,000 20 3 2 2 620,102 45,219 

50,000 20 3 2 2 3,100,102 226,078 

100,000 20 3 2 2 6,200,102 452,153 

500,000 20 3 2 2 31,000,102 2,260,746 

1,000,000 20 3 2 2 62,000,102 4,521,488 

Table 4: GetCapabiliti es filesi ze for SOS B – procedu re is sensor instance 

 

Stations/ Sites /  

FOI 

TS per 

Station 

Lines per   

Proc  

Lines per  

FOI 

Lines per  

ObsProp Lines  

File size 

(kB)  

             

0 (Info onl y)  0 0 0 0 100 4 

1 20 3 2 2 107 4 

10 20 3 2 2 107 4 

100 20 3 2 2 107 4 

1,000 20 3 2 2 107 4 

10,000 20 3 2 2 107 4 

50,000 20 3 2 2 107 4 

100,000 20 3 2 2 107 4 

500,000 20 3 2 2 107 4 



O GC
®
 Surfacewater Interoperability Experiment Final Report * 

 

28 Copyright © 2012 Open Geospati al Consortium  
 

1,000,000 20 3 2 2 107 4 

Table 5: GetCapabliti es filesi ze for SOS C – procedure is sensor network 

 

APPENDIX 2 - ACTIVITY PLAN USE CASES 

1. Cross Border Data Exchange Use Case: The user will discover surface water 
data from cross border or other regions via web map client and then visualize 

the time-series via web sparklines or charts. Once the data has been inspected 
and the user is satisfied that the data is of interest, the user will download the 
data in an appropriate format. 

2. Forecasting Use Case: The user will discover and download data suitable for a 
streamflow forecast. The user will be able to feed a streamflow forecast model 
with this data, but the modeling itself is not part of the scope of this IE. 

3. Global Runoff Use Case: The goal for this use case is to provide automated 
monthly and yearly volume calculations from large rivers discharging to the 

oceans.  Candidate locations for the experiment are from the Global Runoff 
Data Center (GRDC) database. A website is developed from which users can 
view station locations participating in the experiment. The locations are found 

by interrogating a federated catalog of stream gages (gage has phenomena 
discharge for the time period of interest).  Once the map is displayed, users can 
identify a gage of interest and some basic information is displayed in a popup, 

the watershed (catchment) is delineated and displayed.  The user is presented 
with two buttons and a start and end date form. The user enters a start and end 

date and chooses either (1) Monthly volumes or (2) Yearly volumes.  Once a 
button is pressed, the client application requests the daily or instantaneous 
discharge values (in various units) and the website displays a timeseries of 

monthly or yearly calculated volumes in both m^3 and cubic feet.  The 
timeseries is displayed in a table and in a graph with the graph showing gaging 
station information including name, id and basin size.  

The initial set of stations might include the Rhine and the Mississippi Rivers.  

 

 


	Open Geospatial Consortium
	OGC® Surface Water Interoperability Experiment
	FINAL REPORT
	Warning
	None of the Intellectual Property or underlying information or technology may be downloaded or otherwise exported or reexported in violation of U.S. export laws and regulations. In addition, you are responsible for complying with any local laws in you...
	Preface
	1 Introduction
	1.1 Document contributor contact points
	1.2 Revision history
	1.3 Future work

	2 References
	3 Terms and definitions
	4 Conventions
	4.1 `Abbreviated terms
	4.2 UML notation

	5 SWIE Overview
	5.1 Background
	5.2 Motivation and Goals
	5.3 Structure of Report.

	6 Use Case 1 – Cross Border Data Exchange
	6.1 Contributors
	6.2 Introduction
	6.3 Motivation and Goals
	6.4 Design and Implementation
	6.5 Results - outstanding issues
	6.6 Recommendations:
	6.6.1 SOS & OM usage
	6.6.2 Organizational recomendation


	7 Use Case 2 - Forecasting
	7.1 Contributors
	7.2 Introduction
	7.3 Motivation and Goals
	7.4 Design and Implementation
	7.5 Results – outstanding issues
	7.6 Recommendations
	7.6.1 Services Profile
	7.6.2 Issues and Recommendations


	8 Use Case 3 – Global Runoff
	8.1 Contributors
	8.2 Introduction
	8.3 Motivation and Goals
	8.4 Design and Implementation
	8.5 USGS SOS Services
	8.6 USGS SOS Service Results

	9 Results and  outstanding issues
	9.1 SOS Version
	9.2 SOS Usage
	9.2.1 Proposed Solution

	9.3 SWIE SOS Hydrology Profile
	9.3.1 Overview
	9.3.2 Definitions
	9.3.3 Analysis
	9.3.4 Recommendation
	9.3.5 SWIE WaterML 2 Profile


	10 SW IE Client Implementation
	10.1 DelftFEWS SOS Client – Deltares
	10.1.1  Motivation and goals
	10.1.2  Design and Implementation
	10.1.3  Results


	11 Acknowledgements
	Appendix 1 - GetCapabilities document size
	Appendix 2 - Activity plan Use Cases

